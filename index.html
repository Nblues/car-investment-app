<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="รวมรถมือสอง รถบ้านฟรีดาวน์ เชียงใหม่ รถสวยเกรดเอ อัปเดตรถใหม่ทุกวัน รถมือสองเชียงใหม่รูปภาพชัด รถบ้านคุณภาพดีทั่วภาคเหนือ">
  <meta name="keywords" content="รถมือสองเชียงใหม่, รถบ้านฟรีดาวน์, รถมือสองรูปภาพ, รถบ้านเชียงใหม่, รถยนต์มือสอง, รถมือสองภาคเหนือ, รถเต็นท์เชียงใหม่, รถบ้านเชียงราย, รถบ้านลำพูน, รถบ้านลำปาง, รูปรถมือสอง, รถบ้านแท้, รถบ้านเจ้าของขายเอง, รถมือสองฟรีดาวน์, รถมือสองราคาถูก, รถบ้านประวัติดี, รถมือสองยอดนิยม, รถมือสองแนะนำ">
  <meta name="robots" content="index, follow">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="canonical" href="https://kn-goodcar.com/index.html">
  <meta property="og:title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta property="og:description" content="รวมรถบ้านคุณภาพดี รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รับประกัน อัปเดตรถใหม่ทุกวัน เช็กเครดิตออนไลน์ได้ทันที">
  <meta property="og:image" content="https://kn-goodcar.com/cover.jpg">
  <meta property="og:url" content="https://kn-goodcar.com/index.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta name="twitter:description" content="รวมรถบ้านคุณภาพดี รถมือสองเชียงใหม่ ผ่อนถูก ฟรีดาวน์ เช็คเครดิตเร็ว">
  <meta name="twitter:image" content="https://kn-goodcar.com/cover.jpg">
  <style>
    body { font-family: 'Kanit', sans-serif; background: #fafafa; }
    .headline { font-size: 2rem; text-align: center; margin: 32px 0 20px 0; font-weight: bold; }
    .car-card img { object-fit: cover; height: 180px; }
    .car-card { transition: box-shadow .18s; }
    .car-card:hover { box-shadow: 0 4px 32px #0002; }
    .car-title { font-weight: 600; font-size: 1.08em; }
    .car-meta { color: #888; font-size: 0.97em; }
    .car-price { color: #d32f2f; font-weight: bold; font-size: 1.09em; }
    @media (max-width: 768px) { .car-card img { height: 125px; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="headline">รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ อัปเดตรถใหม่ทุกวัน</div>
    <div class="row mb-3 g-2">
      <div class="col-md-4">
        <select id="filter-brand" class="form-select">
          <option value="">ทุกยี่ห้อ</option>
          <option value="Toyota">Toyota</option>
          <option value="Honda">Honda</option>
          <option value="Ford">Ford</option>
          <option value="BMW">BMW</option>
          <option value="Isuzu">Isuzu</option>
          <option value="Mitsubishi">Mitsubishi</option>
          <option value="Mazda">Mazda</option>
          <option value="Chevrolet">Chevrolet</option>
        </select>
      </div>
      <div class="col-md-6">
        <input type="text" id="filter-keyword" class="form-control" placeholder="ค้นหา รุ่น, สี, ปี, ราคา...">
      </div>
      <div class="col-md-2">
        <button class="btn btn-warning w-100" onclick="applyFilters()">ค้นหา</button>
      </div>
    </div>
    <!-- มาร์กจุด: ผลลัพธ์กริดรถ -->
    <div id="product-list" class="row g-3"></div>
    <div class="text-center mt-3 mb-5 fw-bold">
      รวมรถทั้งหมด <span id="total-count">0</span> คัน
    </div>
  </div>
  <script>
    // === Shopify config (แก้ตามระบบจริงได้) ===
    const SHOPIFY_DOMAIN = "kn-goodcar.com";
    const STOREFRONT_ACCESS_TOKEN = "bb70cb008199a94b83c98df0e45ada67";
    // === Fetch car data ===
    async function fetchCars() {
      const query = `{ products(first: 40) { edges { node {
        handle title vendor updatedAt
        images(first:1){edges{node{url}}}
        variants(first:1){edges{node{price{amount}}}}
      }}}}`;
      const res = await fetch(`https://${SHOPIFY_DOMAIN}/api/2023-10/graphql.json`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Shopify-Storefront-Access-Token": STOREFRONT_ACCESS_TOKEN
        },
        body: JSON.stringify({ query })
      });
      const json = await res.json();
      return json.data.products.edges.map(e => e.node);
    }
    let allCars = [];
    async function renderCars() {
      const list = document.getElementById('product-list');
      list.innerHTML = '<div class="text-center py-5">กำลังโหลดข้อมูล...</div>';
      allCars = await fetchCars();
      displayCars(allCars);
    }
    function displayCars(cars) {
      const list = document.getElementById('product-list');
      if (cars.length === 0) {
        list.innerHTML = '<div class="text-center py-4">ไม่พบรถที่ค้นหา</div>';
        document.getElementById('total-count').textContent = 0;
        return;
      }
      list.innerHTML = cars.map(car => `
        <div class="col-6 col-md-4 col-lg-3">
          <div class="card car-card h-100 shadow-sm">
            <a href="car-detail.html?handle=${car.handle}">
              <img src="${car.images.edges[0]?.node.url || 'https://kn-goodcar.com/cover.jpg'}"
                alt="รถมือสอง${car.title} เชียงใหม่ ฟรีดาวน์ เจ้าของขายเอง"
                class="card-img-top" width="100%" height="180" loading="lazy">
            </a>
            <div class="card-body text-center py-2 px-2">
              <div class="car-title mb-1">${car.title}</div>
              <div class="car-price mb-2">฿${Number(car.variants.edges[0]?.node.price.amount || "0").toLocaleString()}</div>
              <div class="car-meta">อัปเดต: ${new Date(car.updatedAt).toLocaleDateString('th-TH')}</div>
            </div>
          </div>
        </div>
      `).join("");
      document.getElementById('total-count').textContent = cars.length;
    }
    function applyFilters() {
      const brand = document.getElementById('filter-brand').value.toLowerCase();
      const kw = document.getElementById('filter-keyword').value.toLowerCase();
      const filtered = allCars.filter(car =>
        (!brand || car.title.toLowerCase().includes(brand)) &&
        (!kw || car.title.toLowerCase().includes(kw) || car.vendor?.toLowerCase().includes(kw))
      );
      displayCars(filtered);
    }
    renderCars();
  </script>
</body>
</html>