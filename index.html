<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย</title>
  <meta name="description" content="รวมรถมือสอง รถบ้านฟรีดาวน์ เชียงใหม่ รถสวยเกรดเอ อัปเดตรถใหม่ทุกวัน รถบ้านคุณภาพดีทั่วภาคเหนือ ดูรูปจริงทุกคัน">
  <meta name="keywords" content="รถมือสองเชียงใหม่, รถบ้านฟรีดาวน์, รถมือสองรูปภาพ, รถบ้านเชียงใหม่, รถยนต์มือสอง, รถมือสองภาคเหนือ, รถเต็นท์เชียงใหม่, รถบ้านเชียงราย, รถบ้านลำพูน, รถบ้านลำปาง, รถมือสองลำพูน, รถมือสองลำปาง, รูปรถมือสอง, รถบ้านแท้, รถบ้านเจ้าของขายเอง, รถมือสองฟรีดาวน์, รถมือสองราคาถูก, รถบ้านประวัติดี, รถมือสองยอดนิยม, รถมือสองแนะนำ, รถมือสองผ่อนถูก, รถมือสองฟรีดาวน์ภาคเหนือ">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://nblues.github.io/car-investment-app/index.html">
  <!-- OG & Twitter -->
  <meta property="og:title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta property="og:description" content="รวมรถบ้านคุณภาพดี รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รับประกัน อัปเดตรถใหม่ทุกวัน เช็กเครดิตออนไลน์ได้ทันที ภาคเหนือ">
  <meta property="og:image" content="https://www.kn-goodcar.com/cover.jpg">
  <meta property="og:url" content="https://nblues.github.io/car-investment-app/index.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta name="twitter:description" content="รวมรถบ้านคุณภาพดี รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รับประกัน อัปเดตรถใหม่ทุกวัน">
  <meta name="twitter:image" content="https://www.kn-goodcar.com/cover.jpg">
  <!-- JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "AutoDealer",
    "name": "ครูหนึ่งรถสวย",
    "image": "https://www.kn-goodcar.com/cover.jpg",
    "url": "https://nblues.github.io/car-investment-app/",
    "address": { "@type": "PostalAddress", "addressRegion": "เชียงใหม่", "addressCountry": "TH" },
    "telephone": "+66940649018",
    "sameAs": [
      "https://www.facebook.com/KN2car",
      "https://lin.ee/zXaTVvJ",
      "https://www.tiktok.com/@krunueng_usedcar",
      "https://youtube.com/@chiangraiusedcar"
    ]
  }
  </script>
  <link rel="icon" href="https://www.kn-goodcar.com/favicon.ico">
  <link rel="preload" as="image" href="https://www.kn-goodcar.com/cover.jpg">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #fafafa; font-family: 'Kanit',sans-serif; }
    .headline { font-size: 2.1em; text-align: center; margin: 30px 0 18px 0; }
    .filter-bar { display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-bottom: 20px; }
    .filter-bar select, .filter-bar input { font-size: 1.08em; padding: 7px 12px; border-radius: 7px; border: 1px solid #eee;}
    .car-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 24px;}
    @media (max-width:1000px){ .car-grid{grid-template-columns:repeat(3,1fr);} }
    @media (max-width:700px){ .car-grid{grid-template-columns:repeat(2,1fr);} .headline{font-size:1.15em;} }
    .car-card { background: #fff; border-radius: 14px; box-shadow:0 2px 10px #0001; overflow: hidden; display: flex; flex-direction: column; transition: box-shadow .15s;}
    .car-card:hover { box-shadow: 0 8px 28px #ea671a28; }
    .car-card a { color: inherit; text-decoration: none; }
    .car-card img { width:100%; aspect-ratio:16/10; object-fit: cover; background: #eee; display: block; border-bottom: 1px solid #eee; transition: transform .2s;}
    .car-card:hover img { transform: scale(1.03);}
    .car-info { padding: 14px 16px 10px 16px; }
    .car-title { font-weight: bold; font-size: 1.07em; margin-bottom: 7px; min-height:52px;}
    .car-price { color: #d32f2f; font-size: 1.1em; font-weight: bold; margin-bottom: 7px;}
    .car-meta { color: #666; font-size: 0.97em; margin-bottom: 3px;}
    .car-status { color: #fff; background: #09c; font-size: 0.97em; padding: 3px 10px; border-radius: 8px; display: inline-block; }
    .car-status.sold { background: #c00; }
    .car-status.reserved { background: #d18700; }
    .pagination {justify-content:center;gap:8px;margin-top:18px;}
    .pagination .page-link {border-radius:7px;color:#ea671a;font-weight:500;}
    .pagination .active .page-link {background:#ea671a;color:#fff;}
  </style>
</head>
<body>
  <main class="container py-2">
    <div class="headline">รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ อัปเดตรถใหม่ทุกวัน <br>รวมรถคุณภาพเกรด A ทั่วภาคเหนือ</div>
    <div class="filter-bar mb-3">
      <select id="filter-brand">
        <option value="">ทุกยี่ห้อ</option>
        <option value="Toyota">Toyota</option>
        <option value="Honda">Honda</option>
        <option value="Ford">Ford</option>
        <option value="BMW">BMW</option>
        <option value="Isuzu">Isuzu</option>
        <option value="Mitsubishi">Mitsubishi</option>
        <option value="Mazda">Mazda</option>
        <option value="Chevrolet">Chevrolet</option>
      </select>
      <input type="text" id="filter-keyword" placeholder="ค้นหา รุ่น, สี, ปี, ราคา..." />
      <button onclick="applyFilters()" class="btn btn-sm btn-warning">ค้นหา</button>
    </div>
    <div id="product-list" class="car-grid"></div>
    <nav>
      <ul class="pagination" id="pagination"></ul>
    </nav>
    <div style="text-align:center;margin:18px 0 8px 0;font-weight:500;">รวมรถทั้งหมด <span id="total-count">0</span> คัน</div>
  </main>
  <!-- Bootstrap JS (Optional) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // ===== Shopify CONFIG =====
    const SHOPIFY_DOMAIN = "kn-goodcar.com";
    const STOREFRONT_ACCESS_TOKEN = "bb70cb008199a94b83c98df0e45ada67";
    // ===== Pagination & State =====
    let allCars = [], filteredCars = [], carsPerPage = 8, curPage = 1;
    // ===== Fetch รถจาก Shopify API =====
    async function fetchCars() {
      const query = `{ products(first: 100) { edges { node {
        handle title vendor updatedAt
        images(first:1){edges{node{url altText}}}
        variants(first:1){edges{node{price{amount}}}}
      }}}}`;
      const res = await fetch(`https://${SHOPIFY_DOMAIN}/api/2023-10/graphql.json`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Shopify-Storefront-Access-Token": STOREFRONT_ACCESS_TOKEN
        },
        body: JSON.stringify({ query })
      });
      const json = await res.json();
      return json.data.products.edges.map(e => e.node);
    }
    // ===== Render รถ กริด Bootstrap 5 แบบ AK Car =====
    function displayCars(cars, page=1) {
      const list = document.getElementById('product-list');
      const total = document.getElementById('total-count');
      // Pagination
      const start = (page-1)*carsPerPage;
      const show = cars.slice(start, start+carsPerPage);
      if (show.length === 0) {
        list.innerHTML = '<div style="grid-column:1/-1;text-align:center;">ไม่พบรถที่ค้นหา</div>';
        total.textContent = 0;
        document.getElementById('pagination').innerHTML = '';
        return;
      }
      list.innerHTML = show.map(car => `
        <div class="car-card shadow-sm">
          <a href="car-detail.html?handle=${car.handle}">
            <img src="${car.images.edges[0]?.node.url || 'https://www.kn-goodcar.com/cover.jpg'}"
                 alt="รถมือสอง${car.title} เชียงใหม่ ฟรีดาวน์ เจ้าของขายเอง"
                 loading="lazy"
                 width="400"
                 height="250">
            <div class="car-info">
              <div class="car-title">${car.title}</div>
              <div class="car-price">฿${Number(car.variants.edges[0]?.node.price.amount || "0").toLocaleString()}</div>
              <div class="car-meta">อัปเดต: ${new Date(car.updatedAt).toLocaleDateString('th-TH')}</div>
            </div>
          </a>
        </div>
      `).join("");
      total.textContent = cars.length;
      // Pagination Bar
      const totalPages = Math.ceil(cars.length / carsPerPage);
      const pag = [];
      for(let i=1;i<=totalPages;i++){
        pag.push(`<li class="page-item${i==page?' active':''}"><a class="page-link" href="#" onclick="gotoPage(${i});return false;">${i}</a></li>`);
      }
      document.getElementById('pagination').innerHTML = pag.join("");
    }
    function gotoPage(page){ curPage = page; displayCars(filteredCars, curPage); }
    // ===== ฟิลเตอร์ =====
    function applyFilters() {
      const brand = document.getElementById('filter-brand').value.toLowerCase();
      const kw = document.getElementById('filter-keyword').value.toLowerCase();
      filteredCars = allCars.filter(car =>
        (!brand || car.title.toLowerCase().includes(brand)) &&
        (!kw || car.title.toLowerCase().includes(kw) || car.vendor?.toLowerCase().includes(kw))
      );
      curPage = 1;
      displayCars(filteredCars, curPage);
    }
    // ====== โหลดข้อมูลและ render ครั้งแรก ======
    async function renderCars() {
      document.getElementById('product-list').innerHTML = '<div style="grid-column:1/-1;text-align:center;">กำลังโหลดข้อมูล...</div>';
      allCars = await fetchCars();
      filteredCars = allCars;
      displayCars(allCars, 1);
    }
    renderCars();
    // ====== Keyboard Enter to Search ======
    document.getElementById('filter-keyword').addEventListener('keydown', e => { if(e.key=='Enter') applyFilters(); });
  </script>
</body>
</html>