<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title id="seo-title">รายละเอียดรถมือสองเชียงใหม่ | ครูหนึ่งรถสวย</title>
  <meta name="description" id="seo-desc" content="รถมือสองเชียงใหม่ ครูหนึ่งรถสวย รถบ้าน ฟรีดาวน์ ราคาถูก ผ่อนสบาย รถสวย เชียงใหม่ รถบ้านแท้ รับประกันคุณภาพ">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="robots" content="index, follow">
  <meta name="keywords" content="รถมือสองเชียงใหม่, รถบ้านเชียงใหม่, รถฟรีดาวน์, รถมือสองฟรีดาวน์, รถยนต์มือสอง, รถมือสองราคาถูก, รถบ้านเจ้าของขายเอง, เต็นท์รถเชียงใหม่, รถใช้แล้วเชียงใหม่, ซื้อขายรถมือสอง, รถมือสองเกรดA, รถบ้านฟรีดาวน์, รถมือสองเชียงราย">
  <link rel="canonical" id="seo-canonical" href="https://kn-goodcar.com/car-detail.html">
  <meta property="og:title" id="og-title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta property="og:description" id="og-desc" content="รายละเอียดรถมือสองเชียงใหม่ รถบ้าน ฟรีดาวน์ ราคาถูก รถสวยคุณภาพดี โดยครูหนึ่งรถสวย เชียงใหม่">
  <meta property="og:image" id="og-image" content="https://kn-goodcar.com/cover.jpg">
  <meta property="og:url" id="og-url" content="https://kn-goodcar.com/car-detail.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" id="tw-title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta name="twitter:description" id="tw-desc" content="รายละเอียดรถมือสองเชียงใหม่ รถบ้าน ฟรีดาวน์ ราคาถูก รถสวยคุณภาพดี โดยครูหนึ่งรถสวย เชียงใหม่">
  <meta name="twitter:image" id="tw-image" content="https://kn-goodcar.com/cover.jpg">
  <!-- JSON-LD Breadcrumb -->
  <script type="application/ld+json" id="breadcrumb-json">{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "รถมือสองเชียงใหม่", "item": "https://kn-goodcar.com/index.html"},
      {"@type": "ListItem", "position": 2, "name": "รายละเอียดรถ", "item": "https://kn-goodcar.com/car-detail.html"}
    ]
  }</script>
  <!-- Organization Schema -->
  <script type="application/ld+json" id="org-json">{
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "ครูหนึ่งรถสวย",
    "url": "https://kn-goodcar.com/",
    "logo": "https://kn-goodcar.com/logo.jpg",
    "sameAs": [
      "https://www.facebook.com/KN2car",
      "https://lin.ee/ng5yM32",
      "https://www.tiktok.com/@krunueng_usedcar",
      "https://youtube.com/@chiangraiusedcar"
    ],
    "contactPoint": [{
      "@type": "ContactPoint",
      "telephone": "+66940649018",
      "contactType": "customer service",
      "areaServed": "TH",
      "availableLanguage": ["Thai"]
    }]
  }</script>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Kanit', sans-serif;
      background: #fafafa;
      color: #222;
      margin: 0;
    }
    .car-detail-container {
      max-width: 700px;
      margin: 40px auto 24px auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 2px 16px #0002;
      overflow: hidden;
    }
    .car-detail-image {
      width: 100%;
      aspect-ratio: 16/9;
      object-fit: cover;
      background: #eee;
      border-radius: 12px 12px 0 0;
    }
    .car-gallery-thumbs {
      display: flex;
      overflow-x: auto;
      gap: 8px;
      padding: 8px 16px;
      background: #f9f9f9;
      border-bottom: 1px solid #eee;
    }
    .car-gallery-thumbs img {
      width: 80px;
      height: 60px;
      object-fit: cover;
      border-radius: 8px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: border 0.2s;
    }
    .car-gallery-thumbs img.active {
      border-color: #ff9800;
    }
    .car-detail-content {
      padding: 24px 24px 12px 24px;
    }
    .car-detail-title {
      font-size: 1.45rem;
      margin-bottom: 0.4em;
    }
    .car-detail-price {
      font-size: 1.22em;
      color: #d32f2f;
      font-weight: bold;
      margin-bottom: 0.5em;
    }
    .car-detail-meta {
      color: #888;
      margin-bottom: 8px;
      font-size: 0.99em;
    }
    .car-detail-desc {
      color: #444;
      font-size: 1.08em;
      margin-bottom: 1em;
      white-space: pre-wrap;
    }
    .car-detail-actions {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-top: 16px;
      align-items: stretch;
    }
    .car-detail-actions a {
      display: block;
      width: 100%;
      padding: 16px 0;
      font-size: 1.13em;
      border-radius: 12px;
      font-weight: 600;
      text-align: center;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: background 0.2s;
      box-sizing: border-box;
    }
    .line-btn { background: #06c755; color: white; }
    .facebook-btn { background: #1877f2; color: white; }
    .back-btn { background: #ff9800; color: white; }
    .car-detail-status {
      margin-bottom: 9px;
      font-size: 1.09em;
      padding: 3px 16px;
      border-radius: 16px;
      display: inline-block;
      font-weight: 700;
      color: #fff;
    }
    .status-wang { background: #FF9800;}
    .status-sold { background: #d32f2f;}
    .status-booked { background: #283593;}
    @media (max-width: 700px){ .car-detail-container { margin: 12px; } }
  </style>
</head>
<body>
  <main>
    <div class="car-detail-container" id="car-detail">
      <img class="car-detail-image" id="car-image" src="https://kn-goodcar.com/cover.jpg" alt="รถมือสองเชียงใหม่">
      <div class="car-gallery-thumbs" id="car-thumbs"></div>
      <div class="car-detail-content">
        <div class="car-detail-title" id="car-title">รายละเอียดรถ...</div>
        <div class="car-detail-status" id="car-status"></div>
        <div class="car-detail-price" id="car-price"></div>
        <div class="car-detail-meta" id="car-meta"></div>
        <div class="car-detail-desc" id="car-desc"></div>
        <div class="car-detail-actions">
          <a class="line-btn" href="https://lin.ee/ng5yM32" target="_blank">สอบถามผ่าน LINE</a>
          <a class="facebook-btn" href="https://www.facebook.com/KN2car" target="_blank">ดูรถบน Facebook</a>
          <a class="back-btn" href="index.html">← กลับหน้ารวมรถ</a>
        </div>
      </div>
    </div>
  </main>
<!-- === ต่อด้านล่างนี้ === -->
<script>
    // ==== CONFIG ====
    const handle = new URLSearchParams(location.search).get("handle");
    const SHOPIFY_DOMAIN = "kn-goodcar.com";
    const STOREFRONT_ACCESS_TOKEN = "bb70cb008199a94b83c98df0e45ada67";
    // ==== END CONFIG ====

    async function fetchCarDetail(handle) {
      const query = `{ productByHandle(handle: "${handle}") {
        title description updatedAt vendor tags
        images(first:20){ edges{ node{ url } } }
        variants(first:1){ edges{ node{ price{ amount } } } }
      }}`;
      const res = await fetch(`https://${SHOPIFY_DOMAIN}/api/2023-10/graphql.json`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Shopify-Storefront-Access-Token": STOREFRONT_ACCESS_TOKEN
        },
        body: JSON.stringify({ query })
      });
      const json = await res.json();
      return json.data.productByHandle;
    }

    async function renderCarDetail() {
      if (!handle) return;
      const car = await fetchCarDetail(handle);
      if (!car) return;
      document.title = car.title + " | ครูหนึ่งรถสวย รถมือสองเชียงใหม่";
      document.getElementById('car-title').textContent = car.title;
      document.getElementById('car-price').textContent = "฿" + Number(car.variants.edges[0]?.node.price.amount || "0").toLocaleString();
      document.getElementById('car-meta').textContent = `${car.vendor || ""} | อัปเดตล่าสุด: ` + new Date(car.updatedAt).toLocaleDateString('th-TH');
      document.getElementById('car-desc').textContent = car.description;

      // สถานะ/ป้าย (ว่าง/จองแล้ว/ขายแล้ว)
      let status = "";
      let css = "";
      if (car.tags.includes("ขายแล้ว")) {
        status = "ขายแล้ว"; css = "status-sold";
      } else if (car.tags.includes("จองแล้ว")) {
        status = "จองแล้ว"; css = "status-booked";
      } else {
        status = "ว่าง"; css = "status-wang";
      }
      const statusDiv = document.getElementById('car-status');
      statusDiv.textContent = status;
      statusDiv.className = "car-detail-status " + css;

      // รูปภาพทั้งหมด + thumbnails
      const images = car.images.edges.map(e => e.node.url);
      const imgMain = document.getElementById('car-image');
      const thumbs = document.getElementById('car-thumbs');
      imgMain.src = images[0] || imgMain.src;
      thumbs.innerHTML = images.map((src, i) => `<img src="${src}" class="${i==0?'active':''}" onclick="switchImg('${src}', this)">`).join("");
      window.switchImg = (src, el) => {
        imgMain.src = src;
        [...thumbs.children].forEach(c => c.classList.remove('active'));
        el.classList.add('active');
      };

      // ---- Dynamic SEO Meta + JSON-LD Product ----
      document.getElementById('seo-title').textContent = car.title + " | ครูหนึ่งรถสวย รถมือสองเชียงใหม่";
      document.getElementById('seo-desc').setAttribute('content', (car.description || "") + " ฟรีดาวน์ เชียงใหม่ รถมือสองราคาถูก รถบ้านคุณภาพดี เชียงใหม่");
      document.getElementById('seo-canonical').setAttribute('href', `https://${SHOPIFY_DOMAIN}/car-detail.html?handle=${handle}`);
      document.getElementById('og-title').setAttribute('content', car.title + " | ครูหนึ่งรถสวย");
      document.getElementById('og-desc').setAttribute('content', car.description);
      document.getElementById('og-image').setAttribute('content', images[0] || "https://kn-goodcar.com/cover.jpg");
      document.getElementById('og-url').setAttribute('content', `https://${SHOPIFY_DOMAIN}/car-detail.html?handle=${handle}`);
      document.getElementById('tw-title').setAttribute('content', car.title + " | ครูหนึ่งรถสวย");
      document.getElementById('tw-desc').setAttribute('content', car.description);
      document.getElementById('tw-image').setAttribute('content', images[0] || "https://kn-goodcar.com/cover.jpg");

      // Schema.org/Product
      const schemaProduct = {
        "@context": "https://schema.org/",
        "@type": "Product",
        "name": car.title,
        "image": images,
        "description": car.description,
        "brand": { "@type": "Brand", "name": (car.title.split(" ")[0] || "รถมือสองเชียงใหม่") },
        "offers": {
          "@type": "Offer",
          "priceCurrency": "THB",
          "price": car.variants.edges[0]?.node.price.amount || "0",
          "availability": status === "ขายแล้ว" ? "https://schema.org/SoldOut" : "https://schema.org/InStock"
        }
      };
      let el = document.getElementById('product-json');
      if (!el) {
        el = document.createElement('script');
        el.type = 'application/ld+json';
        el.id = 'product-json';
        document.head.appendChild(el);
      }
      el.textContent = JSON.stringify(schemaProduct, null, 2);
    }
    renderCarDetail();
  </script>
</body>
</html>