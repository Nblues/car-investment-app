<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย</title>
  <meta name="description" content="รวมรถมือสอง รถบ้านฟรีดาวน์ เชียงใหม่ รถสวยเกรดเอ อัปเดตรถใหม่ทุกวัน รถมือสองเชียงใหม่รูปภาพชัด รถบ้านคุณภาพดีทั่วภาคเหนือ">
  <meta name="keywords" content="รถมือสองเชียงใหม่, รถบ้านฟรีดาวน์, รถมือสองรูปภาพ, รถบ้านเชียงใหม่, รถยนต์มือสอง, รถมือสองภาคเหนือ, รถเต็นท์เชียงใหม่, รถบ้านเชียงราย, รถบ้านลำพูน, รถบ้านลำปาง, รูปรถมือสอง, รถบ้านแท้, รถบ้านเจ้าของขายเอง, รถมือสองฟรีดาวน์, รถมือสองราคาถูก, รถบ้านประวัติดี, รถมือสองยอดนิยม, รถมือสองแนะนำ">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://kn-goodcar.com/index.html">
  <meta property="og:title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta property="og:description" content="รวมรถบ้านคุณภาพดี รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รับประกัน อัปเดตรถใหม่ทุกวัน เช็กเครดิตออนไลน์ได้ทันที">
  <meta property="og:image" content="https://kn-goodcar.com/cover.jpg">
  <meta property="og:url" content="https://kn-goodcar.com/index.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ | ครูหนึ่งรถสวย">
  <meta name="twitter:description" content="รวมรถบ้านคุณภาพดี รถมือสองเชียงใหม่ ผ่อนถูก ฟรีดาวน์ เช็คเครดิตเร็ว">
  <meta name="twitter:image" content="https://kn-goodcar.com/cover.jpg">
  <!-- preload รูปปก -->
  <link rel="preload" as="image" href="https://kn-goodcar.com/cover.jpg">
  <!-- JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "AutoDealer",
    "name": "ครูหนึ่งรถสวย",
    "image": "https://kn-goodcar.com/cover.jpg",
    "url": "https://kn-goodcar.com/",
    "address": { "@type": "PostalAddress", "addressRegion": "เชียงใหม่", "addressCountry": "TH" },
    "telephone": "+66940649018",
    "sameAs": [
      "https://www.facebook.com/KN2car",
      "https://lin.ee/ng5yM32",
      "https://www.tiktok.com/@krunueng_usedcar",
      "https://youtube.com/@chiangraiusedcar"
    ]
  }
  </script>
  <link rel="stylesheet" href="style.css">
  <style>
    body { background: #fafafa; font-family: 'Kanit',sans-serif; margin:0; }
    main { max-width: 1200px; margin:30px auto 30px auto; }
    .headline { font-size: 2.1em; text-align: center; margin: 16px 0 18px 0; }
    .filter-bar { display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-bottom: 20px; }
    .filter-bar select, .filter-bar input { font-size: 1.05em; padding: 7px 10px; border-radius: 7px; border: 1px solid #eee;}
    .product-list { display: grid; grid-template-columns: repeat(auto-fit,minmax(250px,1fr)); gap: 22px; }
    .car-card { background: #fff; border-radius: 14px; box-shadow:0 2px 10px #0001; overflow: hidden; display: flex; flex-direction: column; }
    .car-card a { display:block; }
    .car-card img { width:100%; aspect-ratio:16/10; object-fit: cover; background: #eee; display: block; border-bottom: 1px solid #eee; }
    .car-info { padding: 14px 16px 10px 16px; }
    .car-title { font-weight: bold; font-size: 1.13em; margin-bottom: 7px; }
    .car-price { color: #d32f2f; font-size: 1.1em; font-weight: bold; margin-bottom: 7px;}
    .car-meta { color: #666; font-size: 0.97em; margin-bottom: 3px;}
    .car-status { color: #fff; background: #09c; font-size: 0.97em; padding: 3px 10px; border-radius: 8px; display: inline-block; }
    .car-status.sold { background: #c00; }
    .car-status.reserved { background: #d18700; }
    @media (max-width:700px){ main{padding:10px;} .headline{font-size:1.25em;} }
  </style>
</head>
<body>
  <main>
    <div class="headline">รถมือสองเชียงใหม่ รถบ้านฟรีดาวน์ อัปเดตรถใหม่ทุกวัน <br>รวมรถคุณภาพเกรด A ทั่วภาคเหนือ</div>
    <div class="filter-bar">
      <select id="filter-brand">
        <option value="">ทุกยี่ห้อ</option>
        <option value="Toyota">Toyota</option>
        <option value="Honda">Honda</option>
        <option value="Ford">Ford</option>
        <option value="BMW">BMW</option>
        <option value="Isuzu">Isuzu</option>
        <option value="Mitsubishi">Mitsubishi</option>
        <option value="Mazda">Mazda</option>
        <option value="Chevrolet">Chevrolet</option>
      </select>
      <input type="text" id="filter-keyword" placeholder="ค้นหา รุ่น, สี, ปี, ราคา..." />
      <button onclick="applyFilters()">ค้นหา</button>
    </div>
    <div id="product-list" class="product-list"></div>
    <div style="text-align:center;margin:18px 0 8px 0;font-weight:500;">รวมรถทั้งหมด <span id="total-count">0</span> คัน</div>
  </main>
  <script>
    // CONFIG Shopify
    const SHOPIFY_DOMAIN = "kn-goodcar.com";
    const STOREFRONT_ACCESS_TOKEN = "bb70cb008199a94b83c98df0e45ada67";
    // --- FETCH DATA ---
    async function fetchCars() {
      const query = `{ products(first: 40) { edges { node {
        handle title vendor updatedAt
        images(first:1){edges{node{url}}}
        variants(first:1){edges{node{price{amount}}}}
      }}}}`;
      const res = await fetch(`https://${SHOPIFY_DOMAIN}/api/2023-10/graphql.json`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "X-Shopify-Storefront-Access-Token": STOREFRONT_ACCESS_TOKEN
        },
        body: JSON.stringify({ query })
      });
      const json = await res.json();
      return json.data.products.edges.map(e => e.node);
    }

    let allCars = [];
    async function renderCars() {
      const list = document.getElementById('product-list');
      list.innerHTML = "กำลังโหลดข้อมูล...";
      allCars = await fetchCars();
      displayCars(allCars);
    }

    function displayCars(cars) {
      const list = document.getElementById('product-list');
      if (cars.length === 0) {
        list.innerHTML = '<div style="grid-column:1/-1;text-align:center;">ไม่พบรถที่ค้นหา</div>';
        document.getElementById('total-count').textContent = 0;
        return;
      }
      list.innerHTML = cars.map(car => `
        <div class="car-card">
          <a href="car-detail.html?handle=${car.handle}">
            <img src="${car.images.edges[0]?.node.url || 'https://kn-goodcar.com/cover.jpg'}"
                 alt="รถมือสอง${car.title} เชียงใหม่ ฟรีดาวน์ เจ้าของขายเอง"
                 loading="lazy"
                 width="400"
                 height="250">
          </a>
          <div class="car-info">
            <div class="car-title">${car.title}</div>
            <div class="car-price">฿${Number(car.variants.edges[0]?.node.price.amount || "0").toLocaleString()}</div>
            <div class="car-meta">อัปเดต: ${new Date(car.updatedAt).toLocaleDateString('th-TH')}</div>
          </div>
        </div>
      `).join("");
      document.getElementById('total-count').textContent = cars.length;
    }

    function applyFilters() {
      const brand = document.getElementById('filter-brand').value.toLowerCase();
      const kw = document.getElementById('filter-keyword').value.toLowerCase();
      const filtered = allCars.filter(car =>
        (!brand || car.title.toLowerCase().includes(brand)) &&
        (!kw || car.title.toLowerCase().includes(kw) || car.vendor?.toLowerCase().includes(kw))
      );
      displayCars(filtered);
    }

    renderCars();
  </script>
</body>
</html>
